
{% extends "base.html" %}

{% block link %}
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/python/interview_page.css') }}" />

  <script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
  <!-- CodeMirror CSS & JS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/material.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js"></script>

  <!-- Bootstrap Icons CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
{% endblock %}

{% block title %}Python | Learn{% endblock %}

{% block content %}
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-messages">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}
  <h1 class="heading">
    Professor Python
    <i 
      class="bi bi-question-circle-fill" 
      tabindex="0"
      data-bs-toggle="tooltip" 
      data-bs-placement="right" 
      data-bs-trigger="hover focus click"
      title="Professor Python is your AI tutor, here to help you learn Python.
      To begin your session, just say something like 'Hi' or 'Hello'."
      style="cursor: pointer; font-size: 0.6em; margin-left: 2px;"
    ></i>
  </h1>
  <br>
  <div id="videoContainer">
    <video id="preview" autoplay muted></video>
  </div>

  <div id="chat-box">
    {% for m in messages %}
      <div class="user-message">{{ m.user }}</div>
      <div class="bot-message"><button class="speak-btn" onclick="speakText(this)">ğŸ”Š</button>{{ m.bot | safe | e}}</div>
    {% endfor %}
  </div>
  

  <form id="chat-form">
    <input type="text" id="message" name="message" required autocomplete="off" placeholder="Type your message..." />
    <button type="submit">Send</button>
  </form>
  <!-- <form id="chat-form" class="row gx-2 mb-3">
    <div class="col-12 col-md-10">
      <input type="text" id="message" name="message" class="form-control" placeholder="Type your message..." required>
    </div>
    <div class="col-12 col-md-2">
      <button type="submit" class="btn btn-success w-100">Send</button>
    </div>
  </form> -->

  <hr>
  <div id="transcriptBox">ğŸ¤ <strong>Live Transcription:</strong> <em>Not active</em></div>

  <!-- <div id="controls">
    <input type="checkbox" id="autoSendToggle" />
    <label for="autoSendToggle">Auto-send transcribed speech</label>
    <br>
    <button id="startVoiceBtn">ğŸ™ Start Voice Input</button>
    <button id="chatShowHideBtn" type="button">ğŸ™ˆ Hide Chat</button>
    <button id="showEditorBtn" type="button">ğŸ§  Show Code Editor</button>
    <button id="download-btn" type="button">ğŸ’¾ Download Chat</button>
    <button id="downloadVideoBtn" type="button">ğŸ“¹ Record Video</button>
    <button id="downloadScreenBtn" type="button">ğŸ–¥ï¸ Record Screen</button>
    <button id="muteToggleBtn" type="button">ğŸ”‡ Mute Avatar</button>

  </div> -->
  <div id="controls" class="container my-3">
    <!-- <div class="mb-3">
      <a href="{{ url_for('python.learn_select') }}" class="btn btn-outline-secondary">
        â¬…ï¸ Back
      </a>
    </div> -->

    <div class="form-check mb-3">
      <input class="form-check-input" type="checkbox" id="autoSendToggle" />
      <label class="form-check-label" for="autoSendToggle">Auto-send transcribed speech</label>
    </div>

  <div class="row g-2">
    <div class="col-6 col-md-4 col-lg-3">
      <button id="startVoiceBtn" class="btn btn-outline-primary w-100">ğŸ™ Start Voice Input</button>
    </div>
    <div class="col-6 col-md-4 col-lg-3">
      <button id="chatShowHideBtn" type="button" class="btn btn-outline-secondary w-100">ğŸ™ˆ Hide Chat</button>
    </div>
    <div class="col-6 col-md-4 col-lg-3">
      <button id="showEditorBtn" type="button" class="btn btn-outline-info w-100">ğŸ§  Show Code Editor</button>
    </div>
    <div class="col-6 col-md-4 col-lg-3">
      <button id="download-btn" type="button" class="btn btn-outline-success w-100">ğŸ’¾ Download Chat</button>
    </div>
    <div class="col-6 col-md-4 col-lg-3">
      <button id="downloadVideoBtn" type="button" class="btn btn-outline-dark w-100">ğŸ“¹ Record Video</button>
    </div>
    <div class="col-6 col-md-4 col-lg-3">
      <button id="downloadScreenBtn" type="button" class="btn btn-outline-dark w-100">ğŸ–¥ï¸ Record Screen</button>
    </div>
    <div class="col-6 col-md-4 col-lg-3">
      <button id="muteToggleBtn" type="button" class="btn btn-outline-warning w-100">ğŸ”‡ Mute Avatar Auto Speak</button>
    </div>
    
  </div>

    <!-- Modal -->
<div class="modal fade" id="codeEditorModal" tabindex="-1" aria-labelledby="editorModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Python Code Editor</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        
          <div style="width: 100%; max-width: 100%;">
            <textarea id="pythonCode"></textarea>
          </div>

        <button id="runPythonBtn" class="btn btn-success mt-2">Run</button>
        <button id="copyCodeBtn" class="btn btn-sm btn-secondary mt-2">ğŸ“‹ Copy</button>


        <pre id="pythonOutput" class="mt-3 bg-light p-3 rounded" style="min-height: 100px;"></pre>
      </div>
    </div>
  </div>
</div>


  <!-- AI Avatar -->
  <div id="avatar" class="avatar" title="I'm Professor Python! Drag me around!"></div>

{% endblock %}

{% block script %}
  <script src="{{ url_for('static', filename='js/python/learn.js') }}"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}