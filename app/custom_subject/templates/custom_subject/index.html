{% extends "base.html" %}

{% block title %}Custom Subjects | poro O sekho{% endblock %}

{% block link %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  body {
    background-color: #f8f9fa;
  }
  .chat-message {
    border-radius: 8px;
    padding: 10px 15px;
    margin-bottom: 10px;
  }
  .chat-user {
    background-color: #e9f5ff;
    border: 1px solid #b6e0fe;
  }
  .chat-bot {
    background-color: #f1f3f5;
    border: 1px solid #d6d8db;
  }
  .card {
    border-radius: 12px;
  }
</style>
{% endblock %}

{% block content %}
  <div class="container py-5">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="flash-messages">
          {% for category, message in messages %}
            <div class="alert alert-{{ category }}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
        <div class="mb-4">
          <h2 class="text-primary mb-3">ðŸ§  Subject Workspace</h2>
          <p class="lead text-muted">
            Add a new subject you're interested in learning or practicing, along with an optional syllabus. 
            You can also explore any of your previously added subjects by selecting them below.
          </p>
        </div>

    <!-- Add Subject Section -->
    <h4 class="mb-3 text-success">ðŸ“š Add New Subject</h4>
    <form method="post" action="{{ url_for('custom_subject.index') }}" class="mb-4">
      {{ csrf_token() if csrf_token is defined }}
      <div class="mb-3">
        <label for="subject" class="form-label">
          Subject Name <span class="text-danger">*</span> 
        </label>
        <input type="text" class="form-control" name="subject" id="subject" placeholder="e.g., DSA" required>
      </div>
      <div class="mb-3">
        <label for="syllabus" class="form-label">
          Syllabus  <small class="text-muted">(optional)</small>
        </label>
        <textarea class="form-control" name="syllabus" id="syllabus" rows="3" placeholder="Outline the syllabus..."></textarea>
      </div>
      <button type="submit" class="btn btn-success">âž• Add Subject</button>
    </form>

    {% if subjects %}
      <h5 class="text-primary">ðŸ“„ Added Subjects</h5>
      <ul class="list-group">
        {% for sub in subjects %}
          <li class="list-group-item">
            <a href="{{ url_for('custom_subject.subject', subject=sub.subject, subject_id=sub.subject_id) }}" class="text-decoration-none fw-bold text-primary">
              <strong>{{ sub.subject }}</strong><br>
              <small class="text-muted fst-italic" style="font-size: 0.75rem;">{{ sub.added_at.strftime('%b %d, %Y %I:%M %p') }} UTC</small>
              <br>
              <div class="mt-1 text-muted">{{ sub.syllabus }}</div>
            </a>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-muted">No subjects added yet.</p>
    {% endif %}
    <br>
  </div>
{% endblock %}

{% block script %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  
</script>
{% endblock %}
